<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><title>Custom Marker icon using layout in Android. &middot; Waleed Sarwar</title><meta name="description" content="Recently I was working on an app where I need to draw markers with images of users on the map I googled it and found some solutions and almost all of these solutions are using canvas to draw that kind of custom markers.I was thinking there must be an easier..."><link rel="canonical" href="http://waleedsarwar.com/posts/2016-03-03-custom-markers-google-maps/"><link rel="alternate" type="application/atom+xml" title="Waleed Sarwar Feed" href="http://waleedsarwar.com/feed.xml"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link id="_katexJS" rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.js"><link id="_katexCSS" rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css"> <!--[if gt IE 8]><!----> <script> WebFontConfig = { google: { families: 'Roboto+Slab:700|Noto+Sans:400,400i,700,700i'.split('|') }, custom: { families: ['icomoon'], urls: ['/assets/icomoon/style.css'] } }; </script> <!--<![endif]--> <script> !function(n,e){function t(n,e){n.onload=function(){this.onerror=this.onload=null,e(null,n)},n.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),n)}}function o(n,e){n.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,n))}}n._loaded=!1,n.loadJSDeferred=function(a,d){function r(){n._loaded=!0;var r=e.createElement("script");r.src=a,d&&(("onload"in r?t:o)(r,d),r.onload||t(r,d));var l=e.getElementsByTagName("script")[0];l.parentNode.insertBefore(r,l)}n._loaded?r():n.addEventListener?n.addEventListener("load",r,!1):n.attachEvent?n.attachEvent("onload",r):n.onload=r}}(window,document); !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); window.disablePushState = false; window.disableDrawer = false; </script> <!--[if lt IE 9]> <script src="/assets/bower_components/html5shiv/dist/html5shiv.min.js"></script> <![endif]--> <!--[if gt IE 8]><!----><style> article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}*{box-sizing:border-box}html,body{margin:0;padding:0}html{font-size:16px;line-height:1.75}body{color:#333;background-color:#fff;overflow-y:scroll}a{text-decoration:none}.lead{margin-left:-1rem;margin-right:-1rem}img,.img{max-width:100%;margin-bottom:1rem;border:none}img.lead,.img.lead{max-width:calc(100% + 2rem);width:calc(100% + 2rem)}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.heading{font-weight:bold;text-rendering:optimizeLegibility}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{margin:3rem 0 1rem;line-height:1.6}h1,.h1{font-size:2rem;line-height:1.25}h2,.h2{font-size:1.5rem}h3,.h3{font-size:1.17em}p{margin-top:0;margin-bottom:1rem}p.lead{font-size:1.25rem;font-weight:300;padding:0 1rem}ul,ol,dl{margin-top:0;margin-bottom:1rem}ul,ol{padding-left:1.25rem}hr{position:relative;margin:1.5rem 0;border:0;border-top:1px solid #eee}.hr{padding-bottom:.5rem;border-bottom:1px solid #eee;margin-bottom:1.5rem}h4,h5,h6,.h4,.h5,.h6{margin-bottom:0.5rem;font-size:1rem}table{margin-bottom:1rem;width:100%;width:calc(100% + 2rem);margin-left:-1rem;border:1px solid #e5e5e5;border-collapse:collapse;border-spacing:0}td,th{padding:.25rem .5rem;border:1px solid #e5e5e5}td:first-child,th:first-child{padding-left:1rem}td:last-child,th:last-child{padding-right:1rem}thead+tbody,tbody+tbody,tfoot{border-top:3px double #e5e5e5}tbody tr:nth-child(odd) td,tbody tr:nth-child(odd) th{background-color:#f9f9f9}footer{margin-bottom:2rem}.page,.post{margin-bottom:3em}.page li+li,.post li+li{margin-top:.25rem}.page>header,.post>header{margin-bottom:2rem}.page-title,.post-title{margin-top:0}.post-date{display:block;margin-top:-0.5rem;margin-bottom:1rem;color:#9a9a9a}.related-posts{padding-left:0;list-style:none}.related-posts>li,.related-posts>li+li{margin-top:1rem}.related-posts>li>small,.related-posts>li+li>small{font-size:75%;color:#9a9a9a}.message{margin-bottom:1rem;padding:1rem;color:#787878;background-color:#f9f9f9;margin-left:-1rem;margin-right:-1rem}body,main{position:relative;overflow-x:hidden}@media screen{body::before{content:'';width:.5rem;background:#e5e5e5;position:absolute;left:0;top:0;bottom:0}}@media screen and (min-width: 40em){html{font-size:17px}}@media screen and (min-width: 54em){html{font-size:16px}}@media screen and (min-width: 72em){html{font-size:17px}}@media screen and (min-width: 125em){html{font-size:18px}}.sr-only{display:none}.clearfix,.sidebar-social::after,.clearafter::after{content:"";display:table;clear:both}a,.a{position:relative;padding-bottom:.15rem;border-bottom:1px solid}.img{overflow:hidden;background-color:#f9f9f9}.img>img{margin:0;width:100%;height:100%}.sixteen-nine{position:relative}.sixteen-nine::before{display:block;content:"";width:100%;padding-top:56.25%}.sixteen-nine>*{position:absolute;top:0;left:0;right:0;bottom:0}h1+hr,h2+hr,h3+hr,h4+hr,h5+hr,h6+hr{margin-top:0}.fade-in{animation-duration:500ms;animation-name:fade-in;animation-fill-mode:forwards}@keyframes fade-in{from{transform:translateY(-2rem);opacity:0}50%{transform:translateY(-2rem);opacity:0}to{transform:translateY(0);opacity:1}}.mb6{margin-bottom:6rem}.sidebar{color:rgba(255,255,255,0.75);text-align:left}.sidebar::before{content:"";position:absolute;z-index:2;top:0;left:0;bottom:0;right:0;background:linear-gradient(to bottom, rgba(32,32,32,0) 0%, rgba(32,32,32,0.5) 100%)}.sidebar a{color:#fff;border-bottom-color:rgba(255,255,255,0.2)}#_yDrawer{position:relative;padding:1rem 0}@media screen{#_yDrawer{padding:2rem 1rem;min-height:640px;min-height:100vh}}@media screen and (min-width: 54em){#_yDrawer{position:fixed;top:0;left:0;bottom:0;width:22rem;margin-left:0}}@media screen and (min-width: 97.5em){#_yDrawer{width:calc(50% - 28rem)}}@media screen{#_yDrawer.loaded{min-height:0;padding:0}}.sidebar-bg{position:absolute;top:0;right:0;bottom:0;left:0;background:#202020 center / cover}.sidebar-sticky{position:relative;z-index:3}@media screen{.sidebar-sticky{position:absolute;right:2rem;bottom:1rem;left:auto;max-width:18rem}}@media print{.sidebar-sticky{padding:0 2rem}}.sidebar-about>h1{color:#fff;font-size:2rem}.sidebar-nav>ul{list-style:none;padding-left:0;margin-bottom:.5rem}a.sidebar-nav-item{font-weight:bold;display:block;line-height:1.75;padding:.25rem 0;border-bottom:1px solid rgba(255,255,255,0.2)}@media screen{.y-drawer-scrim{z-index:2}.y-drawer-content{width:22rem;left:-21.5rem;z-index:3}}@media screen and (min-width: 97.5em){.y-drawer-content{width:calc(50% - 28rem)}}.sidebar-social{margin-bottom:.5rem}.sidebar-social>ul{list-style:none;padding-left:0;margin:0 -.25rem}.sidebar-social>ul>li{float:left;margin:0 .25rem}.sidebar-social>ul>li>a{display:inline-block;text-align:center;font-size:1.6rem;line-height:3rem;width:3.1249rem;height:4rem;padding:.5rem 0}.sidebar-social>ul li+li{margin-top:0}.fixed-top{position:fixed;top:0;left:0;width:100%;z-index:1}.navbar>.content{padding-top:0;padding-bottom:0;min-height:0;height:0}.menu{display:inline-block;padding:1.75rem 1.5rem;border-bottom:none;margin-left:-1.5rem;color:#9a9a9a !important}.menu::after{content:"\2630"}@media screen and (min-width: 54em){.menu{padding:1.25rem 1.5rem;position:absolute;left:-9999px}.menu:focus{position:static}}.animation-main{pointer-events:none}.loading{display:none}@media print{.menu{display:none}}.animation-main{opacity:0;will-change:opacity}.loading{position:absolute;top:0;right:0;padding:5.25rem 4.5rem;transform-origin:top right;transform:scale(0.33)}.content{position:relative;margin-left:auto;margin-right:auto;padding:5rem 1rem 12rem}@media screen{.content{max-width:38rem;padding-left:1.5rem;min-height:100vh}}@media screen and (min-width: 54em){.content{max-width:50rem;padding:4rem 1rem 12rem;margin-left:24rem;margin-right:4rem}}@media screen and (min-width: 72em){.content{margin-left:24rem;margin-right:4rem}}@media screen and (min-width: 97.5em){.content{margin:auto}}.me{float:right;width:6.5rem;height:6.5rem;margin-left:1rem;margin-bottom:.5rem;border-radius:100%;position:relative}@media screen and (min-width: 40em){.me{width:7rem;height:7rem}}@media screen and (min-width: 54em){.me{width:6.5rem;height:6.5rem}}@media screen and (min-width: 60em){.me{width:7rem;height:7rem}}main>footer{position:absolute;bottom:0;left:0;right:0;padding:0 1rem;color:#9a9a9a;font-size:smaller;text-align:center}main>footer>p{margin-bottom:0}html{font-family:Helvetica, Arial, sans-serif}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.heading{font-family:Helvetica, Arial, sans-serif}</style><link id="_stylePreload" rel="preload" as="style" href="/assets/css/hydejack.css?v=6.6.1"> <script>document.getElementById('_stylePreload').onload=function(){this.rel='stylesheet'}</script><style id="_pageStyle"> .content a{color:#202020;border-color:rgba(32,32,32,0.2)}.content a:hover{border-color:#202020}:focus{outline-color:#202020}::selection{color:#fff;background:#202020}::-moz-selection{color:#fff;background:#202020}</style><noscript><link rel="stylesheet" href="/assets/css/hydejack.css?v=6.6.1"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700|Noto+Sans:400,400i,700,700i"><style> html { font-family: 'Noto Sans', Helvetica, Arial, sans-serif } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-family: 'Roboto Slab', Helvetica, Arial, sans-serif }</style><link rel="stylesheet" href="/assets/icomoon/style.css"> </noscript> <!--<![endif]--> <!--[if gt IE 8]><!----> <script async src="/assets/bower_components/webfontloader/webfontloader.js"></script> <!--<![endif]--><body><div class="navbar fixed-top"><div class="content"> <span class="sr-only">Jump to:</span> <a id="_menu" class="menu no-hover" href="#_title"> <span class="sr-only">Menu</span> </a></div></div><div id="_yPushState"><div class="fade-in"><main id="_main" class="content" role="main" data-color="#202020" data-image=""><article id="post-posts/custom-markers-google-maps" class="post" role="article"><header><h1 class="post-title"> Custom Marker icon using layout in Android.</h1><p class="post-date heading"> <time datetime="2016-03-03T00:00:00+05:00">03 Mar 2016</time><div class="hr" style="padding-bottom:0"></div></header><p>Recently I was working on an app where I need to draw markers with images of users on the map I googled it and found some solutions and almost all of these solutions are using canvas to draw that kind of custom markers.I was thinking there must be an easier way to do it like converting a layout into the marker and add it to the map. So, in this post, I will show you how to do that.<p>For creating a custom marker create a layout file where we will describe how our custom marker will look like.<p><code class="highlighter-rouge">view_custom_marker.xml</code><div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;FrameLayout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
<span class="na">android:id=</span><span class="s">"@+id/custom_marker_view"</span>
<span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
<span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
<span class="na">android:background=</span><span class="s">"@drawable/marker_mask"</span><span class="nt">&gt;</span>

<span class="nt">&lt;ImageView</span>
  <span class="na">android:id=</span><span class="s">"@+id/profile_image"</span>
  <span class="na">android:layout_width=</span><span class="s">"48dp"</span>
  <span class="na">android:layout_height=</span><span class="s">"48dp"</span>
  <span class="na">android:layout_gravity=</span><span class="s">"center_horizontal"</span>
  <span class="na">android:contentDescription=</span><span class="s">"@null"</span>
  <span class="na">android:src=</span><span class="s">"@drawable/avatar"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/FrameLayout&gt;</span>
</code></pre></div><p>First inflate the <code class="highlighter-rouge">viw_custom_marker.xml</code> file.<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">mCustomMarkerView</span> <span class="o">=</span> <span class="o">((</span><span class="n">LayoutInflater</span><span class="o">)</span> <span class="n">getSystemService</span><span class="o">(</span><span class="n">Context</span><span class="o">.</span><span class="na">LAYOUT_INFLATER_SERVICE</span><span class="o">)).</span><span class="na">inflate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">view_custom_marker</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
 
</code></pre></div><p>Now we will write a method which will take the <code class="highlighter-rouge">mCustomMarkerView</code> and drawable <code class="highlighter-rouge">resId</code> which you want to show on map and convert it into a bitmap.<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/**
* @param view is custom marker layout which we will convert into bitmap.
* @param resId is the drawable which you want to show in marker.
* @return
*/</span>
<span class="kd">private</span> <span class="n">Bitmap</span> <span class="nf">getMarkerBitmapFromView</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">,</span> <span class="nd">@DrawableRes</span> <span class="kt">int</span> <span class="n">resId</span><span class="o">)</span> <span class="o">{</span>

  <span class="n">mMarkerImageView</span><span class="o">.</span><span class="na">setImageResource</span><span class="o">(</span><span class="n">resId</span><span class="o">);</span>
  <span class="n">view</span><span class="o">.</span><span class="na">measure</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">MeasureSpec</span><span class="o">.</span><span class="na">UNSPECIFIED</span><span class="o">,</span> <span class="n">View</span><span class="o">.</span><span class="na">MeasureSpec</span><span class="o">.</span><span class="na">UNSPECIFIED</span><span class="o">);</span>
  <span class="n">view</span><span class="o">.</span><span class="na">layout</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">view</span><span class="o">.</span><span class="na">getMeasuredWidth</span><span class="o">(),</span> <span class="n">view</span><span class="o">.</span><span class="na">getMeasuredHeight</span><span class="o">());</span>
  <span class="n">view</span><span class="o">.</span><span class="na">buildDrawingCache</span><span class="o">();</span>
  <span class="n">Bitmap</span> <span class="n">returnedBitmap</span> <span class="o">=</span> <span class="n">Bitmap</span><span class="o">.</span><span class="na">createBitmap</span><span class="o">(</span><span class="n">view</span><span class="o">.</span><span class="na">getMeasuredWidth</span><span class="o">(),</span> <span class="n">view</span><span class="o">.</span><span class="na">getMeasuredHeight</span><span class="o">(),</span>
          <span class="n">Bitmap</span><span class="o">.</span><span class="na">Config</span><span class="o">.</span><span class="na">ARGB_8888</span><span class="o">);</span>
  <span class="n">Canvas</span> <span class="n">canvas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Canvas</span><span class="o">(</span><span class="n">returnedBitmap</span><span class="o">);</span>
  <span class="n">canvas</span><span class="o">.</span><span class="na">drawColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">WHITE</span><span class="o">,</span> <span class="n">PorterDuff</span><span class="o">.</span><span class="na">Mode</span><span class="o">.</span><span class="na">SRC_IN</span><span class="o">);</span>
  <span class="n">Drawable</span> <span class="n">drawable</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="na">getBackground</span><span class="o">();</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">drawable</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
      <span class="n">drawable</span><span class="o">.</span><span class="na">draw</span><span class="o">(</span><span class="n">canvas</span><span class="o">);</span>
  <span class="n">view</span><span class="o">.</span><span class="na">draw</span><span class="o">(</span><span class="n">canvas</span><span class="o">);</span>
  <span class="k">return</span> <span class="n">returnedBitmap</span><span class="o">;</span>
<span class="o">}</span>
<span class="kd">private</span> <span class="kt">void</span> <span class="nf">addCustomMarkerFromDrawable</span><span class="o">()</span> <span class="o">{</span>

  <span class="k">if</span> <span class="o">(</span><span class="n">mGoogleMap</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="c1">// adding a marker on map with image from  drawable</span>
  <span class="n">mGoogleMap</span><span class="o">.</span><span class="na">addMarker</span><span class="o">(</span><span class="k">new</span> <span class="n">MarkerOptions</span><span class="o">()</span>
          <span class="o">.</span><span class="na">position</span><span class="o">(</span><span class="n">mDummyLatLng</span><span class="o">)</span>
          <span class="o">.</span><span class="na">icon</span><span class="o">(</span><span class="n">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">fromBitmap</span><span class="o">(</span><span class="n">getMarkerBitmapFromView</span><span class="o">(</span><span class="n">mCustomMarkerView</span><span class="o">,</span><span class="n">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">avatar</span><span class="o">))));</span>

<span class="o">}</span>
</code></pre></div><p>I am sure you guys must have a question in your mind what if I want to load an image from the server using <code class="highlighter-rouge">URL</code> and show it on the map. For that, you can use the following code snippet which takes bitmap as an input parameter.<p>Note: For loading an image from url and converting it into a bitmap you can use <code class="highlighter-rouge">Glide</code>, <code class="highlighter-rouge">Picasso</code>.<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/**
* @param view is custom marker layout which we will convert into bitmap.
* @param bitmap is the image which you want to show in marker.
* @return
*/</span>
<span class="kd">private</span> <span class="n">Bitmap</span> <span class="nf">getMarkerBitmapFromView</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">,</span> <span class="n">Bitmap</span> <span class="n">bitmap</span><span class="o">)</span> <span class="o">{</span>

  <span class="n">mMarkerImageView</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">bitmap</span><span class="o">);</span>
  <span class="n">view</span><span class="o">.</span><span class="na">measure</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">MeasureSpec</span><span class="o">.</span><span class="na">UNSPECIFIED</span><span class="o">,</span> <span class="n">View</span><span class="o">.</span><span class="na">MeasureSpec</span><span class="o">.</span><span class="na">UNSPECIFIED</span><span class="o">);</span>
  <span class="n">view</span><span class="o">.</span><span class="na">layout</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">view</span><span class="o">.</span><span class="na">getMeasuredWidth</span><span class="o">(),</span> <span class="n">view</span><span class="o">.</span><span class="na">getMeasuredHeight</span><span class="o">());</span>
  <span class="n">view</span><span class="o">.</span><span class="na">buildDrawingCache</span><span class="o">();</span>
  <span class="n">Bitmap</span> <span class="n">returnedBitmap</span> <span class="o">=</span> <span class="n">Bitmap</span><span class="o">.</span><span class="na">createBitmap</span><span class="o">(</span><span class="n">view</span><span class="o">.</span><span class="na">getMeasuredWidth</span><span class="o">(),</span> <span class="n">view</span><span class="o">.</span><span class="na">getMeasuredHeight</span><span class="o">(),</span>
          <span class="n">Bitmap</span><span class="o">.</span><span class="na">Config</span><span class="o">.</span><span class="na">ARGB_8888</span><span class="o">);</span>
  <span class="n">Canvas</span> <span class="n">canvas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Canvas</span><span class="o">(</span><span class="n">returnedBitmap</span><span class="o">);</span>
  <span class="n">canvas</span><span class="o">.</span><span class="na">drawColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">WHITE</span><span class="o">,</span> <span class="n">PorterDuff</span><span class="o">.</span><span class="na">Mode</span><span class="o">.</span><span class="na">SRC_IN</span><span class="o">);</span>
  <span class="n">Drawable</span> <span class="n">drawable</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="na">getBackground</span><span class="o">();</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">drawable</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
      <span class="n">drawable</span><span class="o">.</span><span class="na">draw</span><span class="o">(</span><span class="n">canvas</span><span class="o">);</span>
  <span class="n">view</span><span class="o">.</span><span class="na">draw</span><span class="o">(</span><span class="n">canvas</span><span class="o">);</span>
  <span class="k">return</span> <span class="n">returnedBitmap</span><span class="o">;</span>

<span class="o">}</span>
<span class="kd">private</span> <span class="kt">void</span> <span class="nf">addCustomMarkerFromURL</span><span class="o">()</span> <span class="o">{</span>

  <span class="k">if</span> <span class="o">(</span><span class="n">mGoogleMap</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="c1">// adding a marker with image from URL using glide image loading library</span>
  <span class="n">Glide</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">())</span>
  <span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">ImageUrl</span><span class="o">).</span><span class="na">asBitmap</span><span class="o">().</span><span class="na">fitCenter</span><span class="o">()</span>
  <span class="o">.</span><span class="na">into</span><span class="o">(</span><span class="k">new</span> <span class="n">SimpleTarget</span><span class="o">&lt;</span><span class="n">Bitmap</span><span class="o">&gt;()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResourceReady</span><span class="o">(</span><span class="n">Bitmap</span> <span class="n">bitmap</span><span class="o">,</span> <span class="n">GlideAnimation</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">Bitmap</span><span class="o">&gt;</span> <span class="n">glideAnimation</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">mGoogleMap</span><span class="o">.</span><span class="na">addMarker</span><span class="o">(</span><span class="k">new</span> <span class="n">MarkerOptions</span><span class="o">().</span><span class="na">position</span><span class="o">(</span><span class="n">mDummyLatLng</span><span class="o">)</span>
        <span class="o">.</span><span class="na">icon</span><span class="o">(</span><span class="n">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">fromBitmap</span><span class="o">(</span><span class="n">getMarkerBitmapFromView</span><span class="o">(</span><span class="n">mCustomMarkerView</span><span class="o">,</span> <span class="n">bitmap</span><span class="o">))));</span>

        <span class="n">mGoogleMap</span><span class="o">.</span><span class="na">animateCamera</span><span class="o">(</span><span class="n">CameraUpdateFactory</span><span class="o">.</span><span class="na">newLatLngZoom</span><span class="o">(</span><span class="n">mDummyLatLng</span><span class="o">,</span> <span class="mi">13</span><span class="n">f</span><span class="o">));</span>

      <span class="o">}</span>
  <span class="o">});</span>

<span class="o">}</span>
              
</code></pre></div><p>Now we just need to call the <code class="highlighter-rouge">addCustomMarkerFromDrawable</code> or <code class="highlighter-rouge">addCustomMarkerFromURL</code> in <code class="highlighter-rouge">onMapReady</code> callback.<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onMapReady</span><span class="o">(</span><span class="n">GoogleMap</span> <span class="n">googleMap</span><span class="o">)</span> <span class="o">{</span>

  <span class="n">mGoogleMap</span> <span class="o">=</span> <span class="n">googleMap</span><span class="o">;</span>
  <span class="n">MapsInitializer</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
  <span class="n">addCustomMarkerFromDrawable</span><span class="o">();</span>
  <span class="c1">//addCustomMarkerFromURL();</span>
<span class="o">}</span>
</code></pre></div><hr /><p><a href="https://github.com/waleedsarwar86/CustomMarkerDemo">Get <em>CustomMarkerDemo</em> on GitHub</a></article><hr class="dingbat" /><aside class="author" role="complementary"><div class="author"> <img src="/assets/img/me.png" class="me" alt="Waleed Sarwar" srcset="/assets/img/me.png 1x,/assets/img/me@2x.png 2x" /><h2 class="page-title hr"> About</h2><p>My name is Waleed. I am an Android Developer from Islamabad Pakistan who loves to build great apps. While crafting applications I take special care of application architecture, testability and performance.<p>I learn every day because I think that learning is a continuos process.I feel that making mistakes is not a crime but not learning from mistakes is.This site is where I write about my experiences and passions.<div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://twitter.com/waleedsarwar86" title="Twitter"> <span class="icon-twitter"></span> <span class="sr-only">Twitter</span> </a><li> <a href="https://github.com/waleedsarwar86" title="GitHub"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a><li> <a href="http://stackoverflow.com/users/3983816/waleedsarwar86" title="Stack Overflow"> <span class="icon-stackoverflow"></span> <span class="sr-only">Stack Overflow</span> </a><li> <a href="https://www.linkedin.com/in/waleedsarwar86" title="LinkedIn"> <span class="icon-linkedin2"></span> <span class="sr-only">LinkedIn</span> </a><li> <a href="mailto:waleed_sarwar@hotmail.com" title="Email"> <span class="icon-mail"></span> <span class="sr-only">Email</span> </a></ul></div></div></aside><aside class="related" role="complementary"><h2 class="hr">Related Posts</h2><ul class="related-posts"></ul></aside><aside class="comments" role="complementary"><h2>Comments</h2><hr/><div id="disqus_thread"></div><script> !function(s,i){function e(e){var t=s.pageYOffset||i.body.scrollTop;s.DISQUS&&!s._disqusThis&&!s._disqusFirst&&t+s.innerHeight>=s._disqusThreadOffsetTop&&(s._disqusThis=!0,s.DISQUS.reset({reload:!0,config:d}))}var d=function(){this.page.title="Custom Marker icon using layout in Android.",this.page.identifier="/posts/custom-markers-google-maps",this.page.url="http://waleedsarwar.com/posts/2016-03-03-custom-markers-google-maps/"};s._disqusFirst=void 0===s._disqusFirst||s._disqusFirst,s._disqusLoading=void 0!==s._disqusLoading&&s._disqusLoading,s._disqusThis=!1,s._disqusThreadOffsetTop=i.getElementById("disqus_thread").offsetTop,s._disqusLoading?s._disqusFirst=!1:(s._disqusLoading=!0,loadJSDeferred("//waleedsarwar86.disqus.com/embed.js"),s.addEventListener?s.addEventListener("scroll",e,{passive:!0}):s.attachEvent?s.attachEvent("onscroll",e):s.onscroll=e)}(window,document); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></aside><footer><hr/><p>© 2017. All rights reserved.</footer></main></div><div id="_yDrawer"><div id="_sidebar" class="sidebar"><div class="sidebar-bg" style="background-color:#202020;background-image:url()"></div><header class="sidebar-sticky" role="banner"><div class="sidebar-about"><h1><a id="_title" href="/">Waleed Sarwar</a></h1><p>“It’s the little details that are vital. Little things make big things happen.” – John Wooden</div><nav class="sidebar-nav heading" role="navigation"> <span class="sr-only">Navigation:</span><ul><li> <a class="sidebar-nav-item" href="/blog/">Blog</a><li> <a class="sidebar-nav-item" href="/projects/">Projects</a><li> <a class="sidebar-nav-item" href="/about/">About</a></ul></nav><div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://twitter.com/waleedsarwar86" title="Twitter"> <span class="icon-twitter"></span> <span class="sr-only">Twitter</span> </a><li> <a href="https://github.com/waleedsarwar86" title="GitHub"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a><li> <a href="http://stackoverflow.com/users/3983816/waleedsarwar86" title="Stack Overflow"> <span class="icon-stackoverflow"></span> <span class="sr-only">Stack Overflow</span> </a><li> <a href="https://www.linkedin.com/in/waleedsarwar86" title="LinkedIn"> <span class="icon-linkedin2"></span> <span class="sr-only">LinkedIn</span> </a><li> <a href="mailto:waleed_sarwar@hotmail.com" title="Email"> <span class="icon-mail"></span> <span class="sr-only">Email</span> </a></ul></div></header></div></div></div><script> window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga('create', '<UA-XXXXXXXX-X>', 'auto'); ga('send', 'pageview'); loadJSDeferred('https://www.google-analytics.com/analytics.js'); </script> <!--[if gt IE 9]><!----> <script>loadJSDeferred('/assets/js/hydejack.js?v=6.6.1');</script> <!--<![endif]-->
</html>
